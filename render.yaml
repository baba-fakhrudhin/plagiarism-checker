services:
  # ============================================
  # Backend Flask API Service
  # ============================================
  - type: web
    name: plagiarism-checker-api
    env: python
    region: oregon
    plan: free
    repo: https://github.com/baba-fakhrudhin/plagiarism-checker
    branch: main
    rootDir: backend
    buildCommand: "pip install -r requirements.txt"
    startCommand: "gunicorn --bind 0.0.0.0:$PORT --workers 2 --threads 2 --worker-class gthread --worker-tmp-dir /dev/shm --timeout 120 run:app"
    autoDeploy: true
    envVars:
      - key: FLASK_ENV
        value: production
      - key: DEBUG
        value: "False"
      - key: PYTHON_VERSION
        value: "3.11.0"
      - key: PORT
        value: "5000"
      - key: SECRET_KEY
        value: xY7kL9pQ2mN5vB3dF8gH1jK4rW6tY9uI0sP
      - key: JWT_SECRET_KEY
        value: m2nN5qR8tU1vW4xY7zA0bC3dE6fG9hI2jK
      - key: UPLOAD_FOLDER
        value: /tmp/uploads
      - key: PYTHONUNBUFFERED
        value: "1"
      - key: DATABASE_URL
        value: postgresql://plagiarism_user:your_password@localhost:5432/plagiarism_checker

  # ============================================
  # Frontend React Service (Static Site)
  # ============================================
  - type: web
    name: plagiarism-checker-web
    env: static
    plan: free
    repo: https://github.com/baba-fakhrudhin/plagiarism-checker
    branch: main
    rootDir: frontend
    buildCommand: "npm install && npm run build"
    staticPublishPath: build
    autoDeploy: true
    envVars:
      - key: REACT_APP_API_URL
        value: https://plagiarism-checker-api.onrender.com/api